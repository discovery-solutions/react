(function(e,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(e=typeof globalThis<"u"?globalThis:e||self,d(e["@dscvr-solutions/react"]={}))})(this,function(e){"use strict";const d={},f=new Map;e.currentComponentInstance=null;const b=(o,t)=>{class n extends HTMLElement{constructor(){super(...arguments),this.props={}}static get observedAttributes(){return["*"]}connectedCallback(){this.props=this.parseAttributes(),d[o]=this;const s=f.get(this);s&&(s.stateIndex=0,s.effectIndex=0);try{e.currentComponentInstance=this;const c=t.call(this,this.props);c.setAttribute("data-reactive",o),this.innerHTML="",this.appendChild(c)}catch(c){console.error(c),this.innerHTML=""}finally{e.currentComponentInstance=null}}attributeChangedCallback(){this.props=this.parseAttributes(),this.connectedCallback()}parseAttributes(){const s={};for(const{name:c,value:i}of Array.from(this.attributes))if(c.startsWith("data-")){const r=c.replace(/^data-/,"");try{s[r]=JSON.parse(i.replace(/'/g,'"'))}catch{s[r]=i}}return s}}customElements.define(o,n)};window.React={functions:{}};const C=(o,...t)=>{var c,i;const n=o.reduce((r,h,E)=>{let a=t[E];if(typeof a=="function"){const l=`fn_${Math.random().toString(36).substring(2,15)}`;window.React.functions[l]=a,a=`window.React.functions.${l}()`}if(Array.isArray(a)&&(a=a.reduce((l,p)=>(l+=p.outerHTML,l),"")),typeof a=="object"&&a!==null)try{a=JSON.stringify(a,(l,p)=>l==="exclude"?void 0:p),a=a.replace(/"/g,"'")}catch{return console.warn("Circular reference detected in:",a),r+h}return r+h+(a||"")},""),u=document.createElement("template");u.innerHTML=n.trim();const s=u.content.firstChild;for(let r=0;r<t.length;r++)((i=(c=t[r])==null?void 0:c.constructor)==null?void 0:i.name)==="Ref"&&(t[r].current=s);return s},v=o=>{const t=new Set;let n=o;return{get:()=>n,set:i=>{i!==n&&(n=i,t.forEach(r=>r(i)))},subscribe:i=>(t.add(i),()=>t.delete(i))}},w=(o,t)=>{if(!e.currentComponentInstance)throw new Error("useEffect must be used within a component.");f.has(e.currentComponentInstance)||f.set(e.currentComponentInstance,{states:[],effects:[],stateIndex:0,effectIndex:0});const n=f.get(e.currentComponentInstance),u=n.effectIndex;n.effects[u]===void 0&&(n.effects[u]={deps:void 0,cleanup:void 0});const s=n.effects[u];n.effectIndex++,(!s.deps||t.length!==s.deps.length?!0:t.some((r,h)=>r!==s.deps[h]))&&(s.cleanup&&s.cleanup(),s.cleanup=void 0,Promise.resolve().then(()=>{s.cleanup=o()||void 0,s.deps=t}),n.effects[u]=s)},g=o=>{if(!e.currentComponentInstance)throw new Error("useState must be used within a component.");f.has(e.currentComponentInstance)||f.set(e.currentComponentInstance,{states:[],effects:[],effectIndex:0,stateIndex:0});const t=f.get(e.currentComponentInstance),n=t.stateIndex;t.stateIndex++,t.states[n]===void 0&&(t.states[n]=o);const u=Object.keys(d).find(c=>d[c]===e.currentComponentInstance),s=c=>{t.states[n]=c,d[u].connectedCallback()};return[t.states[n],s]},y=o=>({current:o});class m extends HTMLElement{connectedCallback(){window.onpopstate=()=>this.updateRoute(),this.updateRoute()}updateRoute(){var n;const t=window.location.pathname;this.innerHTML=((n=this.querySelector(`[data-route="${t}"]`))==null?void 0:n.innerHTML)||"404 Not Found"}}customElements.define("reactive-router",m);class I extends HTMLElement{connectedCallback(){this.addEventListener("click",t=>{t.preventDefault();const n=this.getAttribute("href");n&&(window.history.pushState({},"",n),window.dispatchEvent(new Event("popstate")))})}}customElements.define("reactive-link",I),e.Components=d,e.ReactiveLink=I,e.ReactiveRouter=m,e.componentStates=f,e.createReactiveState=v,e.register=b,e.render=C,e.useEffect=w,e.useRef=y,e.useState=g,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
