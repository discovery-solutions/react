(function(e,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(e=typeof globalThis<"u"?globalThis:e||self,f(e["@dscvr-solutions/react"]={}))})(this,function(e){"use strict";const f={},l=new Map;e.currentComponentInstance=null;const b=(r,t)=>{class n extends HTMLElement{constructor(){super(...arguments),this.props={}}static get observedAttributes(){return["*"]}connectedCallback(){this.props=this.parseAttributes(),f[r]=this;const s=l.get(this);s&&(s.stateIndex=0,s.effectIndex=0);try{e.currentComponentInstance=this;const c=t.call(this,this.props);c.setAttribute("data-reactive",r),this.innerHTML="",this.appendChild(c)}catch(c){console.error(c),this.innerHTML=""}finally{e.currentComponentInstance=null}}attributeChangedCallback(){this.props=this.parseAttributes(),this.connectedCallback()}parseAttributes(){const s={};for(const{name:c,value:a}of Array.from(this.attributes))if(c.startsWith("data-")){const o=c.replace(/^data-/,"");try{s[o]=a.replace(/@'/g,'"').replace(/&quot;/g,'"').replace(/&#39;/g,"'"),s[o]=JSON.parse(s[o])}catch{s[o]=a}}return s}}customElements.define(r,n)};window.React={functions:{}};const g=(r,...t)=>{var c,a;const n=r.reduce((o,h,E)=>{let i=t[E];if(typeof i=="function"){const d=`fn_${Math.random().toString(36).substring(2,15)}`;window.React.functions[d]=i,i=`window.React.functions.${d}()`}if(Array.isArray(i)&&(i=i.reduce((d,p)=>(d+=p.outerHTML,d),"")),typeof i=="object"&&i!==null)try{i=JSON.stringify(i,(d,p)=>d==="exclude"?void 0:p),i=i.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/"/g,"'")}catch(d){return console.log(d),o+h}return o+h+(i||"")},""),u=document.createElement("template");u.innerHTML=n.trim();const s=u.content.firstChild;for(let o=0;o<t.length;o++)((a=(c=t[o])==null?void 0:c.constructor)==null?void 0:a.name)==="Ref"&&(t[o].current=s);return s},C=r=>{const t=new Set;let n=r;return{get:()=>n,set:a=>{a!==n&&(n=a,t.forEach(o=>o(a)))},subscribe:a=>(t.add(a),()=>t.delete(a))}},v=(r,t)=>{if(!e.currentComponentInstance)throw new Error("useEffect must be used within a component.");l.has(e.currentComponentInstance)||l.set(e.currentComponentInstance,{states:[],effects:[],stateIndex:0,effectIndex:0});const n=l.get(e.currentComponentInstance),u=n.effectIndex;n.effects[u]===void 0&&(n.effects[u]={deps:void 0,cleanup:void 0});const s=n.effects[u];n.effectIndex++,(!s.deps||t.length!==s.deps.length?!0:t.some((o,h)=>o!==s.deps[h]))&&(s.cleanup&&s.cleanup(),s.cleanup=void 0,Promise.resolve().then(()=>{s.cleanup=r()||void 0,s.deps=t}),n.effects[u]=s)},w=r=>{if(!e.currentComponentInstance)throw new Error("useState must be used within a component.");l.has(e.currentComponentInstance)||l.set(e.currentComponentInstance,{states:[],effects:[],effectIndex:0,stateIndex:0});const t=l.get(e.currentComponentInstance),n=t.stateIndex;t.stateIndex++,t.states[n]===void 0&&(t.states[n]=r);const u=Object.keys(f).find(c=>f[c]===e.currentComponentInstance),s=c=>{t.states[n]=c,f[u].connectedCallback()};return[t.states[n],s]},y=r=>({current:r});class m extends HTMLElement{connectedCallback(){window.onpopstate=()=>this.updateRoute(),this.updateRoute()}updateRoute(){var n;const t=window.location.pathname;this.innerHTML=((n=this.querySelector(`[data-route="${t}"]`))==null?void 0:n.innerHTML)||"404 Not Found"}}customElements.define("reactive-router",m);class I extends HTMLElement{connectedCallback(){this.addEventListener("click",t=>{t.preventDefault();const n=this.getAttribute("href");n&&(window.history.pushState({},"",n),window.dispatchEvent(new Event("popstate")))})}}customElements.define("reactive-link",I),e.Components=f,e.ReactiveLink=I,e.ReactiveRouter=m,e.componentStates=l,e.createReactiveState=C,e.register=b,e.render=g,e.useEffect=v,e.useRef=y,e.useState=w,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
